# Fast Mail Sender

## Підготовчий етап

### Створення Google таблиці
Google таблиця повинна бути на тому ж акаунті, що і Gmail, або цей акаунт повинен мати доступ до цієї таблиці (немає необхідності робити її доступною за посиланням для всіх).

- створіть два стовпці з текстом `email` та `site`
- скопіюйте посилання на Google таблицю та вставте його в `secure.yml` для значення sheet_url:

Приклад:
![image_goolge_sheet](https://drive.usercontent.google.com/download?id=1FGBgw55tE_8tYeSirLXjmv_iNcF7DZfb&export=view)

### Створення `secure.yml`

Файл `secure.yml` повинен містити наступний вміст:
```yml
sender_email: "your.email@gmail.com" # використовується лише для відправки листів, не потрібен для авторизації
google_credentials: "...googleusercontent.com.json" # файл клієнтського додатку Google
sheet_url: "https://docs.google.com/spreadsheets..."
seconds_between_emails: 240
```

### Зміна теми та тіла листа
У файлі `email_templates.yml` ви можете змінити тіло та тему листа, будьте дуже обережні з пробілами, вони дуже важливі.

Ви можете додати в текст `{site}` або `{reciever_email}`, щоб вставити їх у листи.

### Перевірка наявності всіх файлів у папці

У робочій директорії повинні бути файли:
 - `FastMail`
 - `secure.yml`
 - `email_templates.yml`
 - `...googleusercontent.com.json` (або `token.json`)

Останній файл потрібен для завершення реєстрації, token.json для авторизації у вашому акаунті.

`token.json` створиться програмою автоматично після реєстрації. 

## Запуск

Двічі клацніть на файлі `FastMail`.

або запустіть його з терміналу\cmd

```bash
./FastMail
```

### Перший запуск

Відкриється браузер і попросить підтвердити авторизацію з вашим Google акаунтом.

Це створить `token.json` для наступної автоматичної авторизації у скрипті.

Далі так як файл token.json вже створений - просто запустіть для відправки повідомлень.

### Стандартне використання

Двічі клацніть на файлі, він повинен відкрити термінал і показати процес.

Перед відправкою листа він покаже всі дані з Google таблиці і попросить вас натиснути Enter, якщо все правильно, або Ctrl+C, щоб закрити вікно і скасувати.

Скрипт створить директорію `logs` для перегляду попередніх виконань, ви можете відкрити їх за допомогою будь-якого текстового редактора.

### Прапорці
на mac
- використання: `./FastMail [-h] [--createtoken] [--force] [--workdir WORKDIR]`

на windows
- використання: `./FastMail.exe [-h] [--createtoken] [--force] [--workdir WORKDIR]`

```
опції:
  -h, --help         показати це повідомлення і вийти
  --createtoken      Пересоздати token.json, примусово виконавши нову авторизацію
  --force            Примусово запустити скрипт без очікування введення користувача
  --workdir WORKDIR  Папка, що містить secure.yml і token.json
```
